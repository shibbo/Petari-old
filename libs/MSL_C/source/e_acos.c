#include <cmath>

extern double sqrt(double x);

double __ieee754_acos(double x) {
	double z, p, q, r, w, s, c, df;
	int hx, ix;
	hx = *(int*)&x;
	ix = hx & 0x7FFFFFFF;

	if (ix >= 0x3FF00000) {
	    if (((ix - 0x3ff00000) | *(1 + (int*)&x)) == 0) {
            if (hx > 0) {
                return 0.0;
            }
            else {
                return 3.14159265358979311600e+00 + 2.0 * 6.12323399573676603587e-17;
            }
	    }
	    return NAN;
	}
	if(ix < 0x3FE00000) {
	    if(ix <= 0x3C600000) {
            return 1.57079632679489655800e+00 + 6.12323399573676603587e-17;
        }

	    z = x * x;
	    p = z * (1.66666666666666657415e-01 + z * (-3.25565818622400915405e-01 + z * (2.01212532134862925881e-01 + z * (-4.00555345006794114027e-02 + z * (7.91534994289814532176e-04 + z * 3.47933107596021167570e-05)))));
	    q = 1.00000000000000000000e+00 + z * (-2.40339491173441421878e+00 + z * (2.02094576023350569471e+00 + z * (-6.88283971605453293030e-01 + z * 7.70381505559019352791e-02)));
	    r = p / q;
	    return 1.57079632679489655800e+00 - (x - (6.12323399573676603587e-17 - x * r));
	} else if (hx < 0) {
	    z = (1.00000000000000000000e+00 + x) * 0.5;
	    p = z * (1.66666666666666657415e-01 + z * (-3.25565818622400915405e-01 + z * (2.01212532134862925881e-01 + z * (-4.00555345006794114027e-02 + z * (7.91534994289814532176e-04 + z * 3.47933107596021167570e-05)))));
	    q = 1.00000000000000000000e+00 + z * (-2.40339491173441421878e+00 + z * (2.02094576023350569471e+00 + z * (-6.88283971605453293030e-01 + z * 7.70381505559019352791e-02)));
	    s = sqrt(z);
	    r = p / q;
	    w = r * s - 6.12323399573676603587e-17;
	    return 3.14159265358979311600e+00 - 2.0 * (s + w);
	} else {
	    z = (1.00000000000000000000e+00 - x) * 0.5;
	    s = sqrt(z);
	    df = s;
	    *(1 + (int*)&df) = 0;
	    c = (z - df * df) / (s + df);
	    p = z * (1.66666666666666657415e-01 + z * (-3.25565818622400915405e-01 + z * (2.01212532134862925881e-01 + z * (-4.00555345006794114027e-02 + z * (7.91534994289814532176e-04 + z * 3.47933107596021167570e-05)))));
	    q = 1.00000000000000000000e+00 + z * (-2.40339491173441421878e+00 + z * (2.02094576023350569471e+00 + z * (-6.88283971605453293030e-01 + z * 7.70381505559019352791e-02)));
	    r = p / q;
	    w = r * s + c;
	    return 2.0 * (df + w);
	}
}